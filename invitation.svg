<svg class="sequence simple" width="1718.76953125px" height="850.4000053405762px" xmlns="http://www.w3.org/2000/svg"><desc>invitation.vp</desc><defs><marker viewBox="0 0 5 5" markerWidth="5" markerHeight="5" orient="auto" refX="5" refY="2.5" id="markerArrowBlock"><path d="M 0 0 L 5 2.5 L 0 5 z"></path></marker><marker viewBox="0 0 9.6 16" markerWidth="4" markerHeight="16" orient="auto" refX="9.6" refY="8" id="markerArrowOpen"><path d="M 9.6,8 1.92,16 0,13.7 5.76,8 0,2.286 1.92,0 9.6,8 z"></path></marker></defs><g class="title"><rect x="10" y="10" width="111.421875" height="25" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="15" y="27" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="15">invitation.vp</tspan></text></g><g class="actor"><rect x="356.05859375" y="45" width="59.0078125" height="35" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="366.05859375" y="67" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="366.05859375">Alice</tspan></text></g><g class="actor"><rect x="356.05859375" y="795.4000053405762" width="59.0078125" height="35" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="366.05859375" y="817.4000053405762" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="366.05859375">Alice</tspan></text></g><line x1="385.5625" x2="385.5625" y1="80" y2="795.4000053405762" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="actor"><rect x="788.42578125" y="45" width="66.8125" height="35" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="798.42578125" y="67" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="798.42578125">Server</tspan></text></g><g class="actor"><rect x="788.42578125" y="795.4000053405762" width="66.8125" height="35" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="798.42578125" y="817.4000053405762" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="798.42578125">Server</tspan></text></g><line x1="821.83203125" x2="821.83203125" y1="80" y2="795.4000053405762" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="actor"><rect x="1236.3984375" y="45" width="43.40625" height="35" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="1246.3984375" y="67" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1246.3984375">Bob</tspan></text></g><g class="actor"><rect x="1236.3984375" y="795.4000053405762" width="43.40625" height="35" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="1246.3984375" y="817.4000053405762" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1246.3984375">Bob</tspan></text></g><line x1="1258.1015625" x2="1258.1015625" y1="80" y2="795.4000053405762" stroke="#000000" fill="none" style="stroke-width: 2;"></line><g class="note"><rect x="220.6328125" y="100" width="329.859375" height="71.80000305175781" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="225.6328125" y="117" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="225.6328125">knows private invitation_unlock_key</tspan><tspan dy="1.2em" x="225.6328125">generates invitation_secret</tspan><tspan dy="1.2em" x="225.6328125">knows private alice_server_session_key</tspan><tspan dy="1.2em" x="225.6328125">knows public invitation_id_input_constant</tspan><tspan dy="1.2em" x="225.6328125"></tspan></text></g><g class="note"><rect x="668.60546875" y="191.8000030517578" width="306.453125" height="40.60000038146973" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="673.60546875" y="208.8000030517578" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="673.60546875">knows private alice_server_session_key</tspan><tspan dy="1.2em" x="673.60546875">knows private bob_server_session_key</tspan><tspan dy="1.2em" x="673.60546875"></tspan></text></g><g class="note"><rect x="1112.67578125" y="252.40000343322754" width="290.8515625" height="25" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="1117.67578125" y="269.40000343322754" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="1117.67578125">knows private bob_server_session_key</tspan><tspan dy="1.2em" x="1117.67578125"></tspan></text></g><g class="note"><rect x="10" y="297.40000343322754" width="751.125" height="56.20000076293945" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="15" y="314.40000343322754" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="15">invitation_id = MAC(invitation_unlock_key, invitation_id_input_constant)</tspan><tspan dy="1.2em" x="15">invitation_ciphertext = AEAD_ENC(invitation_unlock_key, invitation_secret, invitation_id)</tspan><tspan dy="1.2em" x="15">invitation_server = ENC(alice_server_session_key, CONCAT(invitation_id, invitation_ciphertext))</tspan><tspan dy="1.2em" x="15"></tspan></text></g><g class="signal"><text x="537.384765625" y="383.100004196167" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="537.384765625">invitation_server</tspan></text><line x1="385.5625" x2="821.83203125" y1="388.600004196167" y2="388.600004196167" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="note"><rect x="395.5625" y="408.600004196167" width="852.5390625" height="25" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="400.5625" y="425.600004196167" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="400.5625">server_invitation_id, server_invitation_ciphertext = SPLIT(DEC(alice_server_session_key, invitation_server))</tspan><tspan dy="1.2em" x="400.5625"></tspan></text></g><g class="note"><rect x="956.65234375" y="453.600004196167" width="602.8984375" height="40.60000038146973" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="961.65234375" y="470.600004196167" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="961.65234375">knows private invitation_unlock_key</tspan><tspan dy="1.2em" x="961.65234375">bob_invitation_id = MAC(invitation_unlock_key, invitation_id_input_constant)</tspan><tspan dy="1.2em" x="961.65234375"></tspan></text></g><g class="signal"><text x="973.654296875" y="523.7000045776367" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="973.654296875">bob_invitation_id</tspan></text><line x1="1258.1015625" x2="821.83203125" y1="529.2000045776367" y2="529.2000045776367" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="note"><rect x="528.18359375" y="549.2000045776367" width="587.296875" height="25" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="533.18359375" y="566.2000045776367" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="533.18359375">invitation_bob = ENC(bob_server_session_key, server_invitation_ciphertext)</tspan><tspan dy="1.2em" x="533.18359375"></tspan></text></g><g class="signal"><text x="985.357421875" y="603.7000045776367" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="985.357421875">invitation_bob</tspan></text><line x1="821.83203125" x2="1258.1015625" y1="609.2000045776367" y2="609.2000045776367" stroke="#000000" fill="none" style="stroke-width: 2; marker-end: url(&quot;#markerArrowBlock&quot;);"></line></g><g class="note"><rect x="859.13671875" y="629.2000045776367" width="797.9296875" height="40.60000038146973" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="864.13671875" y="646.2000045776367" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="864.13671875">bob_invitation_ciphertext = DEC(bob_server_session_key, invitation_bob)</tspan><tspan dy="1.2em" x="864.13671875">bob_invitation_secret = AEAD_DEC(invitation_unlock_key, bob_invitation_ciphertext, bob_invitation_id)</tspan><tspan dy="1.2em" x="864.13671875"></tspan></text></g><g class="note"><rect x="300.953125" y="689.8000049591064" width="64.609375" height="25" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="305.953125" y="706.8000049591064" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="305.953125">phase 1</tspan></text></g><g class="note"><rect x="684.20703125" y="734.8000049591064" width="275.25" height="40.60000038146973" stroke="#000000" fill="#ffffff" style="stroke-width: 2;"></rect><text x="689.20703125" y="751.8000049591064" style="font-size: 16px; font-family: &quot;Andale Mono&quot;, monospace;"><tspan x="689.20703125">leaks server_invitation_ciphertext</tspan><tspan dy="1.2em" x="689.20703125">leaks server_invitation_id</tspan><tspan dy="1.2em" x="689.20703125"></tspan></text></g></svg>